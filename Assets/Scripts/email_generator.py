import pandas as pd
import re

# Load CSV
df = pd.read_csv("C:\\Users\\danie\\Downloads\\emails.csv")   # assumes your file has a header row

# The column that contains emails
email_column = "Email"
study_column = "Study Name"

# Your list of emails to filter out
text = '"De Luna, Jeremiah Edilben" <Jeremiah.DeLuna@utdallas.edu>; "Greta Suchy" <GretaSuchy@outlook.com>; "sarannjac@gmail.com" <sarannjac@gmail.com>; "Bhamitipadi Suresh, Dhanush" <Dhanush.BhamitipadiSuresh@UTDallas.edu>; "Dhulipala, Hridya" <Hridya.Dhulipala@UTDallas.edu>; "Patel, Harsh Rashmikant" <HarshRashmikant.Patel@UTDallas.edu>; "hanahzac@gmail.com" <hanahzac@gmail.com>; "Trost, Hayden Kay" <Hayden.Trost@UTDallas.edu>; "Davis Chacko" <davischackodfw@gmail.com>; "Nasit, Margi T" <Margi.Nasit@UTDallas.edu>; "Chae, Jay" <Jay.Chae@UTDallas.edu>; "Chandrashekhar, Ashwin Sai" <AshwinSai.Chandrashekhar@UTDallas.edu>; "Shin, Sojung" <Sojung.Shin@UTDallas.edu>; "chadswith15@gmail.com" <chadswith15@gmail.com>; "Sahu, Yogeswari" <Yogeswari.Sahu@UTDallas.edu>; "Tilve, Aditya Vasudeo" <AdityaVasudeo.Tilve@UTDallas.edu>; "Carrizales Cavazos, Edilberto Fernando" <Eddie.Carrizales@utdallas.edu>; "dhh19000@utdallas.edu" <dhh19000@utdallas.edu>; "cwongmath@gmail.com" <cwongmath@gmail.com>; "Nguyen, Minh Thu Cao" <MinhThu.Nguyen@UTDallas.edu>; "mohmed.vhora@gmail.com" <mohmed.vhora@gmail.com>; "Allenki, Sathvika" <Sathvika.Allenki@UTDallas.edu>; "m.achanta77@gmail.com" <m.achanta77@gmail.com>; "Raghavendran, Mrinalini" <Mrinalini.Raghavendran@UTDallas.edu>; "Watts, Nicholas Riley" <Nicholas.Watts@UTDallas.edu>; "Kane, Prachi Shekhar" <PrachiShekhar.Kane@UTDallas.edu>; "Basava, Sai Naga Viswa Chaitanya" <SaiNagaViswaChaitanya.Basava@UTDallas.edu>; "Gong, Pengyao" <Pengyao.Gong@UTDallas.edu>; "Rubio, Jake R" <Jake.Rubio@UTDallas.edu>; "Bodapati, Shanmukha Srinivas" <Shanmukha.Bodapati@UTDallas.edu>; "ashwin.r.indurti@gmail.com" <ashwin.r.indurti@gmail.com>; "xinlonghu135@gmail.com" <xinlonghu135@gmail.com>; "Mac, Hillary Hanh Kim" <Hillary.Mac@UTDallas.edu>; "abbas.khawaja@gmail.com" <abbas.khawaja@gmail.com>; "Tran, Evelyn H" <Evelyn.Tran@UTDallas.edu>; "Jonnada, Surya Teja Sri" <Surya.Jonnada@UTDallas.edu>; "Aju, Emmanuvel Joseph" <Emmanuvel.Aju@UTDallas.edu>; "Baskaraswaminathan, Avaneesh Ramaseshan" <AvaneeshRamaseshan.Baskaraswaminathan@UTDallas.edu>; "Hasib, Sofia" <Sofia.Hasib@UTDallas.edu>; "Patel, Dhairya" <Dhairya.Patel2@UTDallas.edu>; "Du, Jacob Keyong" <Jacob.Du@UTDallas.edu>; "gtpradeep11@gmail.com" <gtpradeep11@gmail.com>; "Deng, Shijian" <Shijian.Deng@UTDallas.edu>; "Tubije, John Michael Bustamante" <JohnMichael.Tubije@UTDallas.edu>; "michaelzhao314@gmail.com" <michaelzhao314@gmail.com>; "ayerhs4@gmail.com" <ayerhs4@gmail.com>; "Wynn, Jacian" <Jacian.Wynn@UTDallas.edu>; "Wowo, Ben Nathaniel" <Ben.Wowo@UTDallas.edu>; "Bhadlikar, Sanyukta Dhananjay" <Sanyukta.Bhadlikar@UTDallas.edu>; "vaishu.josyula@gmail.com" <vaishu.josyula@gmail.com>; "Chopparapu, Divyesh Venkata Rama Kumar" <Divyesh.Chopparapu@UTDallas.edu>; "Cherukuri, Kalyan Surya Venkata Nagendra" <Kalyan.Cherukuri@UTDallas.edu>; "Rodriguez, Annette" <Annette.Rodriguez@UTDallas.edu>; "Santhosh, Abhinav" <Abhinav.Santhosh@UTDallas.edu>; "sxc23005@utdallas.edu" <sxc23005@utdallas.edu>; "Parampogu, Sahrudayi Caroline" <SahrudayiCaroline.Parampogu@UTDallas.edu>; "jirehferrer@tamu.edu" <jirehferrer@tamu.edu>; "Mulka, Sai Tharun Reddy" <SaiTharunReddy.Mulka@UTDallas.edu>; "jovitajijo77@gmail.com" <jovitajijo77@gmail.com>; "Visweshwaran, Sashank" <Sashank.Visweshwaran@UTDallas.edu>; "Thota, Yogeswar Reddy" <YogeswarReddy.Thota@UTDallas.edu>; "Cherukuri Kalyan" <svnkalyan@gmail.com>; "Guzman Hernandez, Miguel Andres" <Miguel.GuzmanHernandez@UTDallas.edu>; "Hooda, Yash Singh" <Yash.Hooda@UTDallas.edu>; "Ramanan, Shamitha" <Shamitha.Ramanan@UTDallas.edu>; "oloresjulia@gmail.com" <oloresjulia@gmail.com>; "Perry, Jonathan James" <jperry@utdallas.edu>; "ysinghal2209@gmail.com" <ysinghal2209@gmail.com>; "Udiga, Vivek" <Vivek.Udiga@UTDallas.edu>; "Hernandez, Cynthia Ester" <Cynthia.Hernandez@UTDallas.edu>; "Cardozo, Felipe Ignacio" <Felipe.Cardozo@UTDallas.edu>; "Kalanji, Aditirao Arunkumar" <AditiraoArunkumar.Kalanji@UTDallas.edu>; "Wynn, Jiajun" <Jiajun.Wynn@UTDallas.edu>; "Yuan, Enkang" <Enkang.Yuan@UTDallas.edu>; "danielliu739@gmail.com" <danielliu739@gmail.com>; "Gadad, Prathamesh Sanjay" <Prathamesh.Gadad@UTDallas.edu>; "Andra, Dharmila Chowdary" <DharmilaChowdary.Andra@UTDallas.edu>; "Lamichhane, Samip Shankalpa" <Samip.Lamichhane@UTDallas.edu>; "Nguyen, Gina" <Gina.Nguyen@utdallas.edu>; "Nguyen, Dan N" <Dan.Nguyen@UTDallas.edu>; "Abdelrahim, Awab Mohammed" <Awab.Abdelrahim@UTDallas.edu>; "Jani, Nisarg Asit" <NisargAsit.Jani@UTDallas.edu>; "samiplc24@gmail.com" <samiplc24@gmail.com>; "aidboycap35@gmail.com" <aidboycap35@gmail.com>; "Thadikonda, Naomi Theres" <Naomi.Thadikonda@UTDallas.edu>; "Chen, Yu" <Yu.Chen@UTDallas.edu>; "Devarapalli, Sathwikaa" <Sathwikaa.Devarapalli@UTDallas.edu>; "Maor, Nir Saar" <Nir.Maor@UTDallas.edu>; "eddievillarreal00@outlook.com" <eddievillarreal00@outlook.com>; "Marabad, Sanmati" <Sanmati.Marabad@UTDallas.edu>; "Jagannathan, Harsha" <Harsha.Jagannathan@UTDallas.edu>; "Bae, Jane" <Jane.Bae@UTDallas.edu>; "rafsanzani949@gmail.com" <rafsanzani949@gmail.com>; "Meng, Ruochen" <Ruochen.Meng@UTDallas.edu>; "Lee, Jakin Sunkyo" <Jakin.Lee@UTDallas.edu>; "arjurek1029@gmail.com" <arjurek1029@gmail.com>; "Zhao, Wenjie" <Wenjie.Zhao@UTDallas.edu>; "Leblanc, Zane Michael" <Zane.Leblanc@UTDallas.edu>; "Ummadisetti, Lakshmi Vyshnavi" <LakshmiVyshnavi.Ummadisetti@UTDallas.edu>; "natalie.larksukthom@gmail.com" <natalie.larksukthom@gmail.com>; "iniyanijoseph@gmail.com" <iniyanijoseph@gmail.com>; "Zhao, Zichen" <Zichen.Zhao2@utdallas.edu>; "Potharlanka, Sri Rama Varshith" <SriRamaVarshith.Potharlanka@UTDallas.edu>; "Venkatesan, Nitisha Sree" <NitishaSree.Venkatesan@UTDallas.edu>; "Villarreal, Eddie Javier" <Eddie.Villarreal@UTDallas.edu>; "Kodali, Praharsha" <Praharsha.Kodali@UTDallas.edu>; "allenkisathvika@gmail.com" <allenkisathvika@gmail.com>; "Malaivaiyavur Elayavalli, Swetha" <Swetha.MalaivaiyavurElayavalli@UTDallas.edu>; "Miao, Miao" <Miao.Miao@UTDallas.edu>; "Loetscher, Ryan Adrik" <Ryan.Loetscher@UTDallas.edu>; "jmigueltubije@gmail.com" <jmigueltubije@gmail.com>; "Pratap, Ashish" <Ashish.Pratap@UTDallas.edu>; "ruben.mathew24@gmail.com" <ruben.mathew24@gmail.com>; "Kumar, Shiva A" <Shiva.Kumar@UTDallas.edu>; "Liu, Weicheng" <Weicheng.Liu@UTDallas.edu>; "Surjan, Vedansh Sanjay" <Vedansh.Surjan@UTDallas.edu>; "Sivasamy, Sailekha" <Sailekha.Sivasamy@UTDallas.edu>; "jared.ferrer3@gmail.com" <jared.ferrer3@gmail.com>; "Devkota, Nishchal" <Nishchal.Devkota@UTDallas.edu>; "Josyula, Vaishnavi" <Vaishnavi.Josyula@UTDallas.edu>; "Reece, Ethan Douglas" <Ethan.Reece@UTDallas.edu>; "Li, Jia" <Jia.Li@UTDallas.edu>; Le, Eric <Eric.Le@UTDallas.edu>; Duong, Peyton <Peyton.Duong@UTDallas.edu>; Shih, Winston <Winston.Shih@UTDallas.edu>; Singh, Anand <Anand.Singh2@UTDallas.edu>; Azeem, Syed Hamza <SyedHamza.Azeem@UTDallas.edu>; Khanhkham, Justin L <Justin.Khanhkham@UTDallas.edu>; Hooda, Yash Singh <Yash.Hooda@UTDallas.edu>; Solanki, Aryan <Aryan.Solanki@UTDallas.edu>; Davangere Basavaraj, Nikhil <Nikhil.DavangereBasavaraj@UTDallas.edu>; Gaffney, Nicolas Stephen <Nicolas.Gaffney@UTDallas.edu>; Das, Aankit <Aankit.Das@UTDallas.edu>; Kulkarni, Aditya <Aditya.Kulkarni4@UTDallas.edu>; Khan, Nomaan Akhtar <Nomaan.Khan@utdallas.edu>; Muthukrishnan, Kaushik <Kaushik.Muthukrishnan@UTDallas.edu>; Jeysree, Ajay Kaarthic <AjayKaarthic.Jeysree@UTDallas.edu>; Polu, Maneesh Reddy <ManeeshReddy.Polu@UTDallas.edu>; Joshi, Ishan <Ishan.Joshi@UTDallas.edu>; Rubio, Jake R <Jake.Rubio@UTDallas.edu>; De Luna, Jeremiah Edilben <Jeremiah.DeLuna@utdallas.edu>; Wynn, Jiajun <Jiajun.Wynn@UTDallas.edu>; Yuan, Enkang <Enkang.Yuan@UTDallas.edu>; Gadad, Prathamesh Sanjay <Prathamesh.Gadad@UTDallas.edu>; Shinde, Soham <Soham.Shinde2@UTDallas.edu>; Ogunleye, Temiloluwa Amiel <Temiloluwa.Ogunleye@UTDallas.edu>; Mohan, Sudharssan Thanam <Sudharssan.Mohan@UTDallas.edu>; Gombi, Sanjana <Sanjana.Gombi@UTDallas.edu>; Vallabhbhai, Aryan Dhiru <Aryan.Vallabhbhai@UTDallas.edu>; Venkiteela, Sayeesh <Sayeesh.Venkiteela@UTDallas.edu>; Nomula, Samvrith Reddy <SamvrithReddy.Nomula@UTDallas.edu>; Ranwan, Arush <Arush.Ranwan@UTDallas.edu>; Gaffney, Nicolas Stephen <Nicolas.Gaffney@UTDallas.edu>; Shah, Dhyey Rajesh <dhyey.shah@utdallas.edu>; Seenuvasan, Kavyadharshini <Kavyadharshini.Seenuvasan@UTDallas.edu>; Shinde, Shantanu <Shantanu.Shinde2@UTDallas.edu>; Bourinski, Andrew <Andrew.Bourinski@UTDallas.edu>; Utiel Moreno, Arturo <Arturo.UtielMoreno@UTDallas.edu>; Shaik, Huma F <Huma.Shaik@UTDallas.edu>; Dsouza, Edwin <Edwin.Dsouza@UTDallas.edu>; Chaudhari, Tejas Pramod <Tejas.Chaudhari@UTDallas.edu>; Garcia, Arturo <Arturo.Garcia@UTDallas.edu>; Bikki, Samarth Chowdary <Samarth.Bikki@UTDallas.edu>; Mayo, Caysen <Caysen.Mayo@UTDallas.edu>; Mistry, Hitarth Suresh <Hitarth.Mistry@UTDallas.edu>; Amouh, Lemuel <Lemuel.Amouh@UTDallas.edu>; Ahmed, Haris <Haris.Ahmed@UTDallas.edu>; Roy, Chris <Chris.Roy@UTDallas.edu>; Tomer, Aryaman <Aryaman.Tomer@UTDallas.edu>; Dev, Arnab <Arnab.Dev@UTDallas.edu>; Kulkarni, Tanmay <Tanmay.Kulkarni@UTDallas.edu>; Pothini, Siddharth <Siddharth.Pothini@UTDallas.edu>; Fernandes, Darren Kael <Darren.Fernandes@UTDallas.edu>; Majumder, Aproteem <Aproteem.Majumder@UTDallas.edu>; Wani, Yash Mahendrakumar <YashMahendrakumar.Wani@UTDallas.edu>; Ganesh Kumar, Mukunth Vaibhav <MukunthVaibhav.GaneshKumar@UTDallas.edu>; Baskett, Wesley Logan <Wesley.Baskett@UTDallas.edu>; Giridharan, Nikhil <Nikhil.Giridharan@UTDallas.edu>; Chintala, Adithya <Adithya.Chintala@UTDallas.edu>; Vemulapalli, Krishna Rohith <KrishnaRohith.Vemulapalli@UTDallas.edu>; Gella, Adarsh <Adarsh.Gella@UTDallas.edu>; Mishra, Abinash <Abinash.Mishra@UTDallas.edu>; Mehta, Shayan Chetan <Shayan.Mehta@UTDallas.edu>; Kalanji, Aditirao Arunkumar <AditiraoArunkumar.Kalanji@UTDallas.edu>; Waghmare, Archit Girish <Archit.Waghmare@UTDallas.edu>; Fernwalt, Grant Edward <Grant.Fernwalt@UTDallas.edu>; Shih, Winston <Winston.Shih@UTDallas.edu>; Khan, Hashim <Hashim.Khan@UTDallas.edu>; Pathak, Devarsh Pareshbhai <DevarshPareshbhai.Pathak@UTDallas.edu>; Mallisetty, Rajiv <Rajiv.Mallisetty@UTDallas.edu>; Roy, Chris <Chris.Roy@UTDallas.edu>; Sen, Prajukta <Prajukta.Sen@UTDallas.edu>; Sudarshan, Anirudh <Anirudh.Sudarshan@UTDallas.edu>; Esquivel, Juan David <Juan.Esquivel@UTDallas.edu>; Tran, Megan A <Megan.Tran4@UTDallas.edu>; Borra, Indrani <Indrani.Borra@UTDallas.edu>; Ponce, Godfrey Victor <Godfrey.Ponce@UTDallas.edu>; Ares Arenas, Pablo <Pablo.AresArenas@UTDallas.edu>; Dimitrov, Daniel Kostadinov <Daniel.Dimitrov@UTDallas.edu>; Gonzalez, Leah Harris <Leah.Gonzalez@UTDallas.edu>; Islam, Azfar <Azfar.Islam@UTDallas.edu>; Madapa, Abhiram Reddy <AbhiramReddy.Madapa@UTDallas.edu>; Suresh Kumar, Nandhana <Nandhana.SureshKumar@UTDallas.edu>; Subramanian, Rajeswari <Rajeswari.Subramanian@UTDallas.edu>; Duong, Peyton <Peyton.Duong@UTDallas.edu>; Manoharan, Harish <Harish.Manoharan@UTDallas.edu>; Gikonyo, Martin <Martin.Gikonyo@UTDallas.edu>; Bandaru, Lalith <Lalith.Bandaru@UTDallas.edu>; Rapeti, Siddhu Neehal <SiddhuNeehal.Rapeti@UTDallas.edu>; Tokekar, Sakshi <Sakshi.Tokekar@UTDallas.edu>; Dommaraju, Bhagyasri <Bhagyasri.Dommaraju@UTDallas.edu>; Vega, Anthony <Anthony.Vega@UTDallas.edu>; Ganesh Shankar, Swarna Sre <SwarnaSre.GaneshShankar@UTDallas.edu>; Larson, Evan <Evan.Larson@UTDallas.edu>; Qureshi, Rehan Mohammed <Rehan.Qureshi@UTDallas.edu>; Gerungan, Andrew William <Andrew.Gerungan@UTDallas.edu>; Herkins, Christopher <Christopher.Herkins@UTDallas.edu>; Khaishagi, Mohammad Arham <MohammadArham.Khaishagi@UTDallas.edu>; Bansal, Lavanya <Lavanya.Bansal@UTDallas.edu>; Uppuloori, Uma <Uma.Uppuloori@UTDallas.edu>'
blocked_emails = re.findall(r'<([^>]+)>', text)
print(blocked_emails)

df = df[[email_column]]
df = df.drop_duplicates()
filtered = df[~df[email_column].isin(blocked_emails)]

# Save result to new CSV
filtered.to_csv("filtered_output.csv", index=False)
filtered_out = df[df[email_column].isin(blocked_emails)]

print("Filtered CSV saved as filtered_output.csv")

email_list = filtered[email_column].tolist()
print("Filtered unique emails:")
for email in email_list:
    print(email)

print("\n🚫 Filtered OUT emails (removed):")
for email in filtered_out[email_column].tolist():
    print(email)