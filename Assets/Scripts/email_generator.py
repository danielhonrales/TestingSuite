import pandas as pd
import re

# Load CSV
df = pd.read_csv("C:\\Users\\danie\\Downloads\\Participant Payment Information - 2024(Sheet1).csv")   # assumes your file has a header row

# The column that contains emails
email_column = "Email"
study_column = "Study Name"

# Your list of emails to filter out
text = '"De Luna, Jeremiah Edilben" <Jeremiah.DeLuna@utdallas.edu>; "Greta Suchy" <GretaSuchy@outlook.com>; "sarannjac@gmail.com" <sarannjac@gmail.com>; "Bhamitipadi Suresh, Dhanush" <Dhanush.BhamitipadiSuresh@UTDallas.edu>; "Dhulipala, Hridya" <Hridya.Dhulipala@UTDallas.edu>; "Patel, Harsh Rashmikant" <HarshRashmikant.Patel@UTDallas.edu>; "hanahzac@gmail.com" <hanahzac@gmail.com>; "Trost, Hayden Kay" <Hayden.Trost@UTDallas.edu>; "Davis Chacko" <davischackodfw@gmail.com>; "Nasit, Margi T" <Margi.Nasit@UTDallas.edu>; "Chae, Jay" <Jay.Chae@UTDallas.edu>; "Chandrashekhar, Ashwin Sai" <AshwinSai.Chandrashekhar@UTDallas.edu>; "Shin, Sojung" <Sojung.Shin@UTDallas.edu>; "chadswith15@gmail.com" <chadswith15@gmail.com>; "Sahu, Yogeswari" <Yogeswari.Sahu@UTDallas.edu>; "Tilve, Aditya Vasudeo" <AdityaVasudeo.Tilve@UTDallas.edu>; "Carrizales Cavazos, Edilberto Fernando" <Eddie.Carrizales@utdallas.edu>; "dhh19000@utdallas.edu" <dhh19000@utdallas.edu>; "cwongmath@gmail.com" <cwongmath@gmail.com>; "Nguyen, Minh Thu Cao" <MinhThu.Nguyen@UTDallas.edu>; "mohmed.vhora@gmail.com" <mohmed.vhora@gmail.com>; "Allenki, Sathvika" <Sathvika.Allenki@UTDallas.edu>; "m.achanta77@gmail.com" <m.achanta77@gmail.com>; "Raghavendran, Mrinalini" <Mrinalini.Raghavendran@UTDallas.edu>; "Watts, Nicholas Riley" <Nicholas.Watts@UTDallas.edu>; "Kane, Prachi Shekhar" <PrachiShekhar.Kane@UTDallas.edu>; "Basava, Sai Naga Viswa Chaitanya" <SaiNagaViswaChaitanya.Basava@UTDallas.edu>; "Gong, Pengyao" <Pengyao.Gong@UTDallas.edu>; "Rubio, Jake R" <Jake.Rubio@UTDallas.edu>; "Bodapati, Shanmukha Srinivas" <Shanmukha.Bodapati@UTDallas.edu>; "ashwin.r.indurti@gmail.com" <ashwin.r.indurti@gmail.com>; "xinlonghu135@gmail.com" <xinlonghu135@gmail.com>; "Mac, Hillary Hanh Kim" <Hillary.Mac@UTDallas.edu>; "abbas.khawaja@gmail.com" <abbas.khawaja@gmail.com>; "Tran, Evelyn H" <Evelyn.Tran@UTDallas.edu>; "Jonnada, Surya Teja Sri" <Surya.Jonnada@UTDallas.edu>; "Aju, Emmanuvel Joseph" <Emmanuvel.Aju@UTDallas.edu>; "Baskaraswaminathan, Avaneesh Ramaseshan" <AvaneeshRamaseshan.Baskaraswaminathan@UTDallas.edu>; "Hasib, Sofia" <Sofia.Hasib@UTDallas.edu>; "Patel, Dhairya" <Dhairya.Patel2@UTDallas.edu>; "Du, Jacob Keyong" <Jacob.Du@UTDallas.edu>; "gtpradeep11@gmail.com" <gtpradeep11@gmail.com>; "Deng, Shijian" <Shijian.Deng@UTDallas.edu>; "Tubije, John Michael Bustamante" <JohnMichael.Tubije@UTDallas.edu>; "michaelzhao314@gmail.com" <michaelzhao314@gmail.com>; "ayerhs4@gmail.com" <ayerhs4@gmail.com>; "Wynn, Jacian" <Jacian.Wynn@UTDallas.edu>; "Wowo, Ben Nathaniel" <Ben.Wowo@UTDallas.edu>; "Bhadlikar, Sanyukta Dhananjay" <Sanyukta.Bhadlikar@UTDallas.edu>; "vaishu.josyula@gmail.com" <vaishu.josyula@gmail.com>; "Chopparapu, Divyesh Venkata Rama Kumar" <Divyesh.Chopparapu@UTDallas.edu>; "Cherukuri, Surya Venkata Nagendra Kalyan" <Kalyan.Cherukuri@UTDallas.edu>; "Rodriguez, Annette" <Annette.Rodriguez@UTDallas.edu>; "Santhosh, Abhinav" <Abhinav.Santhosh@UTDallas.edu>; "sxc23005@utdallas.edu" <sxc23005@utdallas.edu>; "Parampogu, Sahrudayi Caroline" <SahrudayiCaroline.Parampogu@UTDallas.edu>; "jirehferrer@tamu.edu" <jirehferrer@tamu.edu>; "Mulka, Sai Tharun Reddy" <SaiTharunReddy.Mulka@UTDallas.edu>; "jovitajijo77@gmail.com" <jovitajijo77@gmail.com>; "Visweshwaran, Sashank" <Sashank.Visweshwaran@UTDallas.edu>; "Thota, Yogeswar Reddy" <YogeswarReddy.Thota@UTDallas.edu>; "Cherukuri Kalyan" <svnkalyan@gmail.com>; "Guzman Hernandez, Miguel Andres" <Miguel.GuzmanHernandez@UTDallas.edu>; "Ramanan, Shamitha" <Shamitha.Ramanan@UTDallas.edu>; "oloresjulia@gmail.com" <oloresjulia@gmail.com>; "Perry, Jonathan James" <jperry@utdallas.edu>; "ysinghal2209@gmail.com" <ysinghal2209@gmail.com>; "Udiga, Vivek" <Vivek.Udiga@UTDallas.edu>; "Hernandez, Sin" <Cynthia.Hernandez@UTDallas.edu>; "Cardozo, Felipe Ignacio" <Felipe.Cardozo@UTDallas.edu>; "Kalanji, Aditirao Arunkumar" <AditiraoArunkumar.Kalanji@UTDallas.edu>; "Wynn, Jiajun" <Jiajun.Wynn@UTDallas.edu>; "Yuan, Enkang" <Enkang.Yuan@UTDallas.edu>; "danielliu739@gmail.com" <danielliu739@gmail.com>; "Gadad, Prathamesh Sanjay" <Prathamesh.Gadad@UTDallas.edu>; "Andra, Dharmila Chowdary" <DharmilaChowdary.Andra@UTDallas.edu>; "Lamichhane, Samip Shankalpa" <Samip.Lamichhane@UTDallas.edu>; "Nguyen, Gina" <Gina.Nguyen@utdallas.edu>; "Nguyen, Dan N" <Dan.Nguyen@UTDallas.edu>; "Abdelrahim, Awab Mohammed" <Awab.Abdelrahim@UTDallas.edu>; "Jani, Nisarg Asit" <NisargAsit.Jani@UTDallas.edu>; "samiplc24@gmail.com" <samiplc24@gmail.com>; "aidboycap35@gmail.com" <aidboycap35@gmail.com>; "Thadikonda, Naomi Theres" <Naomi.Thadikonda@UTDallas.edu>; "Chen, Yu" <Yu.Chen@UTDallas.edu>; "Devarapalli, Sathwikaa" <Sathwikaa.Devarapalli@UTDallas.edu>; "Maor, Nir Saar" <Nir.Maor@UTDallas.edu>; "eddievillarreal00@outlook.com" <eddievillarreal00@outlook.com>; "Marabad, Sanmati" <Sanmati.Marabad@UTDallas.edu>; "Jagannathan, Harsha" <Harsha.Jagannathan@UTDallas.edu>; "Bae, Jane" <Jane.Bae@UTDallas.edu>; "rafsanzani949@gmail.com" <rafsanzani949@gmail.com>; "Meng, Ruochen" <Ruochen.Meng@UTDallas.edu>; "Lee, Jakin Sunkyo" <Jakin.Lee@UTDallas.edu>; "arjurek1029@gmail.com" <arjurek1029@gmail.com>; "Zhao, Wenjie" <Wenjie.Zhao@UTDallas.edu>; "Leblanc, Zane Michael" <Zane.Leblanc@UTDallas.edu>; "Ummadisetti, Lakshmi Vyshnavi" <LakshmiVyshnavi.Ummadisetti@UTDallas.edu>; "natalie.larksukthom@gmail.com" <natalie.larksukthom@gmail.com>; "iniyanijoseph@gmail.com" <iniyanijoseph@gmail.com>; "Zhao, Zichen" <Zichen.Zhao2@utdallas.edu>; "Potharlanka, Sri Rama Varshith" <SriRamaVarshith.Potharlanka@UTDallas.edu>; "Venkatesan, Nitisha Sree" <NitishaSree.Venkatesan@UTDallas.edu>; "Villarreal, Eddie Javier" <Eddie.Villarreal@UTDallas.edu>; "Kodali, Praharsha" <Praharsha.Kodali@UTDallas.edu>; "allenkisathvika@gmail.com" <allenkisathvika@gmail.com>; "Malaivaiyavur Elayavalli, Swetha" <Swetha.MalaivaiyavurElayavalli@UTDallas.edu>; "Miao, Miao" <Miao.Miao@UTDallas.edu>; "Loetscher, Ryan Adrik" <Ryan.Loetscher@UTDallas.edu>; "jmigueltubije@gmail.com" <jmigueltubije@gmail.com>; "ruben.mathew24@gmail.com" <ruben.mathew24@gmail.com>; "Kumar, Shiva A" <Shiva.Kumar@UTDallas.edu>; "Liu, Weicheng" <Weicheng.Liu@UTDallas.edu>; "Surjan, Vedansh Sanjay" <Vedansh.Surjan@UTDallas.edu>; "Sivasamy, Sailekha" <Sailekha.Sivasamy@UTDallas.edu>; "jared.ferrer3@gmail.com" <jared.ferrer3@gmail.com>; "Devkota, Nishchal" <Nishchal.Devkota@UTDallas.edu>; "Josyula, Vaishnavi" <Vaishnavi.Josyula@UTDallas.edu>; "Reece, Ethan Douglas" <Ethan.Reece@UTDallas.edu>; "Li, Jia" <Jia.Li@UTDallas.edu>'
blocked_emails = re.findall(r'<([^>]+)>', text)
print(blocked_emails)

df = df[[email_column]]
df = df.drop_duplicates()
filtered = df[~df[email_column].isin(blocked_emails)]

# Save result to new CSV
filtered.to_csv("filtered_output.csv", index=False)
filtered_out = df[df[email_column].isin(blocked_emails)]

print("Filtered CSV saved as filtered_output.csv")

email_list = filtered[email_column].tolist()
print("Filtered unique emails:")
for email in email_list:
    print(email)

print("\nðŸš« Filtered OUT emails (removed):")
for email in filtered_out[email_column].tolist():
    print(email)